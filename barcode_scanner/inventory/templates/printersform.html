{% extends 'base.html' %}
{% load widget_tweaks %}

{% block title %}{% if printers %}Edit Printer{% else %}Add Printer{% endif %} - Asset Management{% endblock %}

{% block content %}
<div class="page-header">
  <div>
    <nav style="font-size: 0.875rem; color: var(--gray-500); margin-bottom: var(--space-2);">
      <a href="{% url 'home' %}" style="color: var(--primary); text-decoration: none;">Dashboard</a>
      <i class="bi bi-chevron-right" style="margin: 0 8px;"></i>
      <a href="{% url 'printers_list' %}" style="color: var(--primary); text-decoration: none;">Printers</a>
      <i class="bi bi-chevron-right" style="margin: 0 8px;"></i>
      <span>{% if printers %}{{ printers.service_tag }}{% else %}New Printer{% endif %}</span>
    </nav>
    <h1 class="page-title">{% if printers %}Edit Printer{% else %}Add New Printer{% endif %}</h1>
  </div>
</div>

<div style="display: grid; grid-template-columns: 1fr; gap: var(--space-6);">
  <div class="card">
    <div class="card-header">
      <div style="display: flex; align-items: center; gap: var(--space-3);">
        <div style="width: 40px; height: 40px; border-radius: var(--radius); background: linear-gradient(135deg, var(--info), #0284c7); display: flex; align-items: center; justify-content: center; color: white;">
          <i class="bi bi-printer"></i>
        </div>
        <h3 class="card-title">Printer Details</h3>
      </div>
      {% if printers %}
      <a href="{% url 'delete_printer' printers.id %}" class="btn btn-error btn-sm" onclick="return confirm('Delete this printer?');">
        <i class="bi bi-trash"></i> Delete
      </a>
      {% endif %}
    </div>

    <form method="post" {% if url %}action="{{ url }}"{% endif %}>
      {% csrf_token %}
      <div class="card-body">
        <div style="display: grid; grid-template-columns: repeat(1, 1fr); gap: var(--space-4);">
          {% for item in form %}
          <div class="form-group" style="margin-bottom: 0;">
            <label class="form-label">{{ item.label }}</label>
            {% render_field item class="form-input" placeholder=item.label %}
          </div>
          {% endfor %}
        </div>
      </div>
      <div class="card-footer" style="display: flex; flex-wrap: wrap; gap: var(--space-3); justify-content: space-between;">
        <a href="{% url 'printers_list' %}" class="btn btn-secondary">
          <i class="bi bi-arrow-left"></i> Back
        </a>
        <button type="submit" class="btn btn-primary">
          <i class="bi bi-check-lg"></i> {% if printers %}Save{% else %}Add Printer{% endif %}
        </button>
      </div>
    </form>
  </div>

  {% if printers %}
  <div class="card">
    <div class="card-header">
      <div style="display: flex; align-items: center; gap: var(--space-2);">
        <i class="bi bi-laptop" style="color: var(--primary);"></i>
        <span class="card-title">Linked Computers</span>
      </div>
    </div>
    <div class="card-body">
      {% if printers.Computers.all %}
        <div style="display: flex; flex-wrap: wrap; gap: var(--space-2);">
        {% for computer in printers.Computers.all %}
          <a href="{% url 'computers_form' computer.id %}" class="tag tag-warning" style="padding: var(--space-2) var(--space-3);">
            <i class="bi bi-laptop"></i> {{ computer }}
          </a>
        {% endfor %}
        </div>
      {% else %}
        <p style="color: var(--gray-500); text-align: center; padding: var(--space-4);">No computers linked to this printer</p>
      {% endif %}
    </div>
  </div>
  {% endif %}
</div>

<style>
  @media (min-width: 768px) {
    .card-body > div { grid-template-columns: repeat(2, 1fr) !important; }
  }
</style>
{% endblock %}
